# ğŸ¯ Studio æœ€æœ‰ä»·å€¼åœºæ™¯ä¸æœ€ä½³å®ç°æ–¹æ¡ˆ

> **ç‰ˆæœ¬**: 1.0.0
> **æ›´æ–°æ—¥æœŸ**: 2026-01-14
> **è¯´æ˜**: åˆ†æ Studio çš„æ ¸å¿ƒä»·å€¼åœºæ™¯ï¼Œå‚è€ƒ CrewAI ç­‰ç«å“å®ç°ï¼Œè®¾è®¡æœ€ä½³å®ç°æ–¹æ¡ˆ

---

## ğŸ“‹ ç›®å½•

1. [æ ¸å¿ƒä»·å€¼åœºæ™¯](#æ ¸å¿ƒä»·å€¼åœºæ™¯)
2. [CrewAI Studio å®ç°åˆ†æ](#crewai-studio-å®ç°åˆ†æ)
3. [æœ€ä½³å®ç°æ–¹æ¡ˆ](#æœ€ä½³å®ç°æ–¹æ¡ˆ)
4. [æŠ€æœ¯æ¶æ„è®¾è®¡](#æŠ€æœ¯æ¶æ„è®¾è®¡)
5. [å®æ–½è·¯çº¿å›¾](#å®æ–½è·¯çº¿å›¾)

---

## æ ¸å¿ƒä»·å€¼åœºæ™¯

### 1.1 åœºæ™¯ä»·å€¼çŸ©é˜µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          åœºæ™¯ä»·å€¼çŸ©é˜µ                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  åœºæ™¯                    â”‚ ç”¨æˆ·ä»·å€¼ â”‚ æŠ€æœ¯éš¾åº¦ â”‚ ä¼˜å…ˆçº§ â”‚ ç«å“æ”¯æŒ              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  å¯¹è¯å¼åˆ›å»º              â”‚ â­â­â­â­â­ â”‚ â­â­     â”‚ P0    â”‚ Dify âœ… Coze âœ…      â”‚
â”‚  å¯è§†åŒ–ç¼–æ’              â”‚ â­â­â­â­â­ â”‚ â­â­â­â­   â”‚ P0    â”‚ å…¨éƒ¨æ”¯æŒ             â”‚
â”‚  å®æ—¶è°ƒè¯•è¿½è¸ª            â”‚ â­â­â­â­â­ â”‚ â­â­â­    â”‚ P0    â”‚ Dify âœ… LangFlow âœ…  â”‚
â”‚  ä¸€é”®éƒ¨ç½²                â”‚ â­â­â­â­   â”‚ â­â­â­    â”‚ P1    â”‚ Dify âœ… n8n âœ…      â”‚
â”‚  æ¨¡æ¿å¸‚åœº                â”‚ â­â­â­â­   â”‚ â­â­     â”‚ P1    â”‚ å…¨éƒ¨æ”¯æŒ             â”‚
â”‚  æç¤ºè¯å·¥ç¨‹              â”‚ â­â­â­     â”‚ â­â­     â”‚ P1    â”‚ Dify âœ… Coze âœ…      â”‚
â”‚  ä»£ç å¯¼å‡º                â”‚ â­â­â­     â”‚ â­â­     â”‚ P2    â”‚ LangFlow âœ…          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 åœºæ™¯ä¸€ï¼šå¯¹è¯å¼åˆ›å»º - é™ä½ä½¿ç”¨é—¨æ§›

**ä»·å€¼**: â­â­â­â­â­
**ç›®æ ‡ç”¨æˆ·**: ä¸šåŠ¡äººå‘˜ã€äº§å“ç»ç†

#### åœºæ™¯æè¿°

ç”¨æˆ·é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ Agent é…ç½®ï¼Œæ— éœ€ç¼–ç¨‹çŸ¥è¯†ã€‚

```
ç”¨æˆ·: "æˆ‘éœ€è¦ä¸€ä¸ªå®¢æœAgentï¼Œèƒ½å›ç­”äº§å“é—®é¢˜ï¼ŒæŸ¥è¯¢è®¢å•çŠ¶æ€ï¼Œå¿…è¦æ—¶è½¬äººå·¥"

ç³»ç»Ÿ: "å¥½çš„ï¼Œæˆ‘æ¥å¸®æ‚¨åˆ›å»ºã€‚è¯·é—®ï¼š
      1. äº§å“çŸ¥è¯†åº“æ˜¯å¦å·²å‡†å¤‡å¥½ï¼Ÿ
      2. è®¢å•ç³»ç»Ÿæ˜¯å¦æœ‰APIå¯ä»¥è°ƒç”¨ï¼Ÿ
      3. è½¬äººå·¥çš„æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ"

ç”¨æˆ·: "çŸ¥è¯†åº“å·²å‡†å¤‡å¥½ï¼Œè®¢å•APIæ˜¯ https://api.example.com/ordersï¼Œå½“ç”¨æˆ·æ˜ç¡®è¦æ±‚è½¬äººå·¥æ—¶è½¬æ¥"

ç³»ç»Ÿ: "âœ… å·²ä¸ºæ‚¨åˆ›å»ºå®¢æœAgentï¼ŒåŒ…å«ï¼š
      â€¢ çŸ¥è¯†åº“æ£€ç´¢å·¥å…·
      â€¢ è®¢å•æŸ¥è¯¢å·¥å…·
      â€¢ è½¬äººå·¥é€»è¾‘

      [æŸ¥çœ‹é…ç½®] [è¿›å…¥ç¼–è¾‘å™¨] [ç«‹å³æµ‹è¯•]"
```

#### æ ¸å¿ƒä»·å€¼

1. **é›¶ä»£ç é—¨æ§›**: ä¸šåŠ¡äººå‘˜æ— éœ€å­¦ä¹ ç¼–ç¨‹å³å¯åˆ›å»º Agent
2. **å¿«é€ŸéªŒè¯**: 5åˆ†é’Ÿå†…ä»æƒ³æ³•åˆ°å¯è¿è¡Œçš„ Agent
3. **æ™ºèƒ½ç†è§£**: AI ç†è§£ä¸šåŠ¡éœ€æ±‚ï¼Œè‡ªåŠ¨ç”Ÿæˆåˆç†é…ç½®
4. **è¿­ä»£ä¼˜åŒ–**: é€šè¿‡å¯¹è¯æŒç»­è°ƒæ•´ï¼Œç›´åˆ°æ»¡æ„

#### å®ç°è¦ç‚¹

```python
# backend/core/studio/creator/agent_creator.py

class AgentCreator:
    """å¯¹è¯å¼Agentåˆ›å»ºå™¨"""

    async def create_from_conversation(
        self,
        user_input: str,
        context: dict,
    ) -> AsyncGenerator[CreatorEvent, None]:
        """
        å¯¹è¯å¼åˆ›å»ºæµç¨‹

        1. æ„å›¾ç†è§£ - åˆ†æç”¨æˆ·éœ€æ±‚
        2. ä¿¡æ¯æ”¶é›† - è¿½é—®ç¼ºå¤±ä¿¡æ¯
        3. é…ç½®ç”Ÿæˆ - è‡ªåŠ¨ç”ŸæˆAgenté…ç½®
        4. é¢„è§ˆç¡®è®¤ - å±•ç¤ºé…ç½®ä¾›ç”¨æˆ·ç¡®è®¤
        5. åˆ›å»ºå®Œæˆ - ä¿å­˜å¹¶è¿”å›Agent
        """
        # 1. æ„å›¾ç†è§£
        intent = await self._parse_intent(user_input, context)
        yield CreatorEvent(type="thinking", data={"message": "æ­£åœ¨åˆ†ææ‚¨çš„éœ€æ±‚..."})

        # 2. ä¿¡æ¯æ”¶é›†
        missing_info = await self._check_missing_info(intent)
        if missing_info:
            for question in missing_info:
                yield CreatorEvent(type="question", data={"question": question})
            return

        # 3. é…ç½®ç”Ÿæˆ
        yield CreatorEvent(type="generating", data={"message": "æ­£åœ¨ç”ŸæˆAgenté…ç½®..."})
        config = await self._generate_config(intent, context)

        # 4. é¢„è§ˆç¡®è®¤
        yield CreatorEvent(type="preview", data={"config": config})

        # 5. åˆ›å»ºå®Œæˆ
        agent = await self._create_agent(config)
        yield CreatorEvent(type="done", data={"agent_id": agent.id})
```

### 1.3 åœºæ™¯äºŒï¼šå¯è§†åŒ–ç¼–æ’ - å¤æ‚å·¥ä½œæµè®¾è®¡

**ä»·å€¼**: â­â­â­â­â­
**ç›®æ ‡ç”¨æˆ·**: äº§å“ç»ç†ã€å¼€å‘è€…

#### åœºæ™¯æè¿°

é€šè¿‡æ‹–æ‹½èŠ‚ç‚¹ã€è¿æ¥è¾¹çš„æ–¹å¼ï¼Œå¯è§†åŒ–è®¾è®¡å¤æ‚çš„ Agent å·¥ä½œæµï¼Œæ”¯æŒæ¡ä»¶åˆ†æ”¯ã€å¾ªç¯ã€å¹¶è¡Œç­‰é«˜çº§é€»è¾‘ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¯è§†åŒ–ç¼–æ’ç•Œé¢                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚  â”‚  START  â”‚                                                               â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                               â”‚
â”‚       â”‚                                                                    â”‚
â”‚       â–¼                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚  â”‚  æ„å›¾è¯†åˆ«   â”‚                                                           â”‚
â”‚  â”‚ (LLMèŠ‚ç‚¹)   â”‚                                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â–¼                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚  â”‚  æ¡ä»¶è·¯ç”±   â”‚                                                           â”‚
â”‚  â”‚ (æ¡ä»¶èŠ‚ç‚¹)  â”‚                                                           â”‚
â”‚  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                                                           â”‚
â”‚     â”‚      â”‚                                                                â”‚
â”‚     â–¼      â–¼      â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”                                                     â”‚
â”‚  â”‚é—®ç­”â”‚ â”‚æŸ¥è¯¢â”‚ â”‚è½¬äººâ”‚                                                     â”‚
â”‚  â”‚å¤„ç†â”‚ â”‚è®¢å•â”‚ â”‚ å·¥ â”‚                                                     â”‚
â”‚  â””â”€â”€â”¬â”€â”˜ â””â”€â”€â”¬â”€â”˜ â””â”€â”€â”¬â”€â”˜                                                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜                                                         â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â–¼                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚  â”‚   END   â”‚                                                               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ ¸å¿ƒä»·å€¼

1. **ç›´è§‚è®¾è®¡**: å¯è§†åŒ–å±•ç¤ºå·¥ä½œæµé€»è¾‘ï¼Œæ˜“äºç†è§£å’Œæ²Ÿé€š
2. **å¤æ‚é€»è¾‘**: æ”¯æŒæ¡ä»¶åˆ†æ”¯ã€å¾ªç¯ã€å¹¶è¡Œç­‰å¤æ‚åœºæ™¯
3. **Code-First**: åº•å±‚æ˜¯ Python ä»£ç ï¼Œå¯è§†åŒ–åªæ˜¯æ¸²æŸ“å±‚
4. **åŒå‘ç¼–è¾‘**: ä»£ç å’Œå¯è§†åŒ–å®æ—¶åŒæ­¥ï¼Œçµæ´»åˆ‡æ¢

#### å®ç°è¦ç‚¹

```python
# backend/core/studio/codegen/graph_codegen.py

class LangGraphCodeGen:
    """LangGraph ä»£ç ç”Ÿæˆå™¨"""

    def from_react_flow(
        self,
        nodes: list[dict],
        edges: list[dict],
    ) -> str:
        """
        ä» React Flow æ•°æ®ç”Ÿæˆ Python ä»£ç 

        è¾“å…¥: React Flow æ ¼å¼çš„èŠ‚ç‚¹å’Œè¾¹
        è¾“å‡º: å¯æ‰§è¡Œçš„ LangGraph Python ä»£ç 
        """
        code_lines = []

        # 1. ç”Ÿæˆå¯¼å…¥
        code_lines.extend(self._generate_imports())

        # 2. ç”ŸæˆçŠ¶æ€ç±»
        code_lines.extend(self._generate_state_class())

        # 3. ç”ŸæˆèŠ‚ç‚¹å‡½æ•°
        for node in nodes:
            code_lines.extend(self._generate_node_function(node))

        # 4. ç”Ÿæˆæ¡ä»¶å‡½æ•°
        for edge in edges:
            if edge.get("type") == "conditional":
                code_lines.extend(self._generate_condition_function(edge))

        # 5. ç”Ÿæˆå›¾å®šä¹‰
        code_lines.extend(self._generate_graph_definition(nodes, edges))

        return "\n".join(code_lines)
```

### 1.4 åœºæ™¯ä¸‰ï¼šå®æ—¶è°ƒè¯•è¿½è¸ª - å¿«é€Ÿè¿­ä»£

**ä»·å€¼**: â­â­â­â­â­
**ç›®æ ‡ç”¨æˆ·**: å¼€å‘è€…ã€Promptå·¥ç¨‹å¸ˆ

#### åœºæ™¯æè¿°

æ‰§è¡Œ Agent æ—¶ï¼Œå®æ—¶å¯è§†åŒ–å±•ç¤ºæ¯ä¸€æ­¥çš„æ‰§è¡Œè¿‡ç¨‹ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹æ‰§è¡Œã€LLMè°ƒç”¨ã€å·¥å…·è°ƒç”¨ã€çŠ¶æ€å˜åŒ–ç­‰ï¼Œæ”¯æŒæ—¶é—´æ—…è¡Œè°ƒè¯•ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®æ—¶è°ƒè¯•è¿½è¸ªç•Œé¢                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      æ‰§è¡Œæµç¨‹            â”‚  â”‚           æ‰§è¡Œæ—¥å¿—                      â”‚  â”‚
â”‚  â”‚  (èŠ‚ç‚¹é«˜äº®)              â”‚  â”‚  (å®æ—¶æ»šåŠ¨)                            â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                         â”‚  â”‚  ğŸ• 10:23:45.123                        â”‚  â”‚
â”‚  â”‚  [å…¥å£] âœ“               â”‚  â”‚  â–¶ å¼€å§‹æ‰§è¡Œ                            â”‚  â”‚
â”‚  â”‚    â†“                    â”‚  â”‚    â”‚                                    â”‚  â”‚
â”‚  â”‚  [æ€è€ƒ] ğŸ”µ              â”‚  â”‚    â”œâ”€â–¶ ä¸Šä¸‹æ–‡ç»„è£… (23ms)                â”‚  â”‚
â”‚  â”‚    â†“                    â”‚  â”‚    â”‚   â”œâ”€ System: 1,234 tokens          â”‚  â”‚
â”‚  â”‚  [æ‰§è¡Œ] â—‹               â”‚  â”‚    â”‚   â”œâ”€ History: 2,456 tokens        â”‚  â”‚
â”‚  â”‚    â†“                    â”‚  â”‚    â”‚   â””â”€ Memory: 892 tokens            â”‚  â”‚
â”‚  â”‚  [è¾“å‡º] â—‹               â”‚  â”‚    â”‚                                    â”‚  â”‚
â”‚  â”‚                         â”‚  â”‚    â”œâ”€â–¶ LLMè°ƒç”¨ (1,234ms)                â”‚  â”‚
â”‚  â”‚  å½“å‰: æ€è€ƒ             â”‚  â”‚    â”‚   â”œâ”€ Model: claude-3.5             â”‚  â”‚
â”‚  â”‚  è€—æ—¶: 2.3s             â”‚  â”‚    â”‚   â”œâ”€ Input: 4,582 tokens           â”‚  â”‚
â”‚  â”‚                         â”‚  â”‚    â”‚   â””â”€ Output: 156 tokens            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚                                    â”‚  â”‚
â”‚                               â”‚    â”œâ”€â–¶ å·¥å…·è°ƒç”¨: query_order            â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚   â”œâ”€ Args: {order_id: "xxx"}      â”‚  â”‚
â”‚  â”‚      å½“å‰çŠ¶æ€            â”‚  â”‚    â”‚   â”œâ”€ Duration: 234ms              â”‚  â”‚
â”‚  â”‚  (å®æ—¶æ›´æ–°)              â”‚  â”‚    â”‚   â””â”€ Result: {status: "å·²å‘è´§"}   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚    â”‚                                    â”‚  â”‚
â”‚  â”‚ messages: 3            â”‚  â”‚    â”œâ”€â–¶ LLMè°ƒç”¨ (892ms)                  â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚  â”‚    â”‚   â””â”€ ç”Ÿæˆæœ€ç»ˆå“åº”                  â”‚  â”‚
â”‚  â”‚ user: "å¸®æˆ‘..."        â”‚  â”‚    â”‚                                    â”‚  â”‚
â”‚  â”‚ assistant: ...         â”‚  â”‚    â””â”€â–¶ å®Œæˆ âœ“                           â”‚  â”‚
â”‚  â”‚                        â”‚  â”‚                                          â”‚  â”‚
â”‚  â”‚ context:               â”‚  â”‚  æ€»è€—æ—¶: 2,383ms                         â”‚  â”‚
â”‚  â”‚ { plan: [...] }        â”‚  â”‚  Tokenæ¶ˆè€—: 4,738                        â”‚  â”‚
â”‚  â”‚                        â”‚  â”‚  é¢„ä¼°æˆæœ¬: $0.0142                       â”‚  â”‚
â”‚  â”‚ iteration: 2           â”‚  â”‚                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚  [å±•å¼€å…¨éƒ¨] [å¯¼å‡ºæ—¥å¿—] [é‡æ”¾] [æ—¶é—´æ—…è¡Œ]                                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ ¸å¿ƒä»·å€¼

1. **å¯è§†åŒ–æ‰§è¡Œ**: ç›´è§‚çœ‹åˆ°æ¯ä¸€æ­¥çš„æ‰§è¡Œè¿‡ç¨‹
2. **å¿«é€Ÿå®šä½**: ç«‹å³å‘ç°æ€§èƒ½ç“¶é¢ˆå’Œé”™è¯¯
3. **æ—¶é—´æ—…è¡Œ**: ç‚¹å‡»å†å²äº‹ä»¶æŸ¥çœ‹å½“æ—¶çŠ¶æ€
4. **æˆæœ¬é€æ˜**: å®æ—¶æ˜¾ç¤º Token æ¶ˆè€—å’Œæˆæœ¬

#### å®ç°è¦ç‚¹

```python
# backend/core/engine/agent.py

class AgentEngine:
    """Agent æ‰§è¡Œå¼•æ“"""

    async def run_with_trace(
        self,
        user_input: str,
        session_id: str,
    ) -> AsyncGenerator[EngineEvent, None]:
        """
        å¸¦è¿½è¸ªçš„æ‰§è¡Œæ¨¡å¼

        é€šè¿‡ WebSocket å®æ—¶æ¨é€æ‰§è¡Œäº‹ä»¶åˆ°å‰ç«¯
        """
        # 1. èŠ‚ç‚¹è¿›å…¥
        yield EngineEvent(
            type=EventType.NODE_ENTER,
            data={"node_id": "start", "timestamp": time.time()}
        )

        # 2. ä¸Šä¸‹æ–‡æ„å»º
        yield EngineEvent(
            type=EventType.CONTEXT_BUILD_START,
            data={"timestamp": time.time()}
        )
        context = await self.context_manager.build(...)
        yield EngineEvent(
            type=EventType.CONTEXT_BUILD_COMPLETE,
            data={"context": context, "duration_ms": 23}
        )

        # 3. LLMè°ƒç”¨
        yield EngineEvent(
            type=EventType.LLM_CALL_START,
            data={"model": "claude-3.5", "input_tokens": 4582}
        )

        async for chunk in self.llm_gateway.stream_chat(...):
            yield EngineEvent(
                type=EventType.LLM_STREAM_CHUNK,
                data={"chunk": chunk}
            )

        yield EngineEvent(
            type=EventType.LLM_CALL_COMPLETE,
            data={"output_tokens": 156, "duration_ms": 1234}
        )

        # 4. å·¥å…·è°ƒç”¨
        yield EngineEvent(
            type=EventType.TOOL_CALL_START,
            data={"tool": "query_order", "args": {"order_id": "xxx"}}
        )
        result = await self.tool_executor.execute(...)
        yield EngineEvent(
            type=EventType.TOOL_CALL_COMPLETE,
            data={"result": result, "duration_ms": 234}
        )

        # 5. èŠ‚ç‚¹å®Œæˆ
        yield EngineEvent(
            type=EventType.NODE_EXIT,
            data={"node_id": "end", "timestamp": time.time()}
        )
```

### 1.5 åœºæ™¯å››ï¼šä¸€é”®éƒ¨ç½² - å¿«é€Ÿä¸Šçº¿

**ä»·å€¼**: â­â­â­â­
**ç›®æ ‡ç”¨æˆ·**: å¼€å‘è€…ã€è¿ç»´äººå‘˜

#### åœºæ™¯æè¿°

å·¥ä½œå°åˆ›å»ºçš„ Agent å¯ä»¥ä¸€é”®éƒ¨ç½²ä¸º API æœåŠ¡ã€Web åº”ç”¨ã€åµŒå…¥ç»„ä»¶æˆ–å¯¼å‡ºä»£ç ï¼Œæ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²ã€‚

```
ç”¨æˆ·æ“ä½œ: [å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒ]

ç³»ç»Ÿå¤„ç†:
1. ç¼–è¯‘å·¥ä½œæµ â†’ Agenté…ç½®
2. åˆ›å»ºéƒ¨ç½²è®°å½•
3. ç”ŸæˆAPIç«¯ç‚¹
4. é…ç½®è®¤è¯å’Œé™æµ
5. å¯åŠ¨æœåŠ¡å®ä¾‹

ç»“æœ:
âœ… éƒ¨ç½²æˆåŠŸ
ğŸ“¡ APIç«¯ç‚¹: https://api.example.com/v1/agents/customer-service
ğŸ”‘ API Key: sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ğŸ“š APIæ–‡æ¡£: https://docs.example.com/api/customer-service
```

#### æ ¸å¿ƒä»·å€¼

1. **é›¶è¿ç»´**: æ— éœ€æ‰‹åŠ¨é…ç½®æœåŠ¡å™¨å’Œéƒ¨ç½²æµç¨‹
2. **å¤šç¯å¢ƒ**: æ”¯æŒå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒ
3. **å¤šå½¢å¼**: APIã€Webã€åµŒå…¥ç»„ä»¶ã€ä»£ç å¯¼å‡º
4. **ç‰ˆæœ¬ç®¡ç†**: æ”¯æŒå›æ»šå’Œç°åº¦å‘å¸ƒ

---

## CrewAI Studio å®ç°åˆ†æ

### 2.1 CrewAI Studio æ ¸å¿ƒç‰¹æ€§

æ ¹æ®è°ƒç ”ï¼ŒCrewAI Studio æä¾›ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

1. **å¯è§†åŒ–ç¼–è¾‘å™¨**: æ‹–æ‹½å¼ Agent ç¼–æ’ç•Œé¢
2. **AI åŠ©æ‰‹**: æ™ºèƒ½è¾…åŠ©åˆ›å»ºå’Œä¼˜åŒ– Agent
3. **å¤šæ¨¡å‹æ”¯æŒ**: ç»Ÿä¸€ç®¡ç† GPTã€Claudeã€æ–‡å¿ƒä¸€è¨€ç­‰æ¨¡å‹
4. **æ™ºèƒ½è°ƒåº¦**: è‡ªåŠ¨é€‰æ‹©æœ€é€‚åˆçš„ AI æ¨¡å‹å¤„ç†ä¸åŒä»»åŠ¡

### 2.2 æ¶æ„åˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CrewAI Studio æ¶æ„æ¨æµ‹                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  å‰ç«¯å±‚:                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å¯è§†åŒ–ç¼–è¾‘å™¨ (React/Vue)                                             â”‚  â”‚
â”‚  â”‚  â€¢ æ‹–æ‹½èŠ‚ç‚¹                                                           â”‚  â”‚
â”‚  â”‚  â€¢ è¿æ¥è¾¹                                                             â”‚  â”‚
â”‚  â”‚  â€¢ é…ç½®å±æ€§                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  æœåŠ¡å±‚:                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç¼–æ’å¼•æ“                                                             â”‚  â”‚
â”‚  â”‚  â€¢ å·¥ä½œæµæ‰§è¡Œ                                                        â”‚  â”‚
â”‚  â”‚  â€¢ ä»»åŠ¡è°ƒåº¦                                                           â”‚  â”‚
â”‚  â”‚  â€¢ æ¨¡å‹é€‰æ‹©                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  æ ¸å¿ƒå±‚:                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CrewAI Core                                                         â”‚  â”‚
â”‚  â”‚  â€¢ Agent æ‰§è¡Œ                                                        â”‚  â”‚
â”‚  â”‚  â€¢ å·¥å…·è°ƒç”¨                                                           â”‚  â”‚
â”‚  â”‚  â€¢ è®°å¿†ç®¡ç†                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 å¯å€Ÿé‰´çš„è®¾è®¡

1. **æ™ºèƒ½æ¨¡å‹è°ƒåº¦**: æ ¹æ®ä»»åŠ¡ç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹
2. **å¯è§†åŒ–ç¼–æ’**: ç›´è§‚çš„æ‹–æ‹½å¼ç•Œé¢
3. **AI è¾…åŠ©**: ä½¿ç”¨ AI å¸®åŠ©ç”¨æˆ·åˆ›å»ºå’Œä¼˜åŒ– Agent
4. **å¤šæ¨¡å‹ç»Ÿä¸€ç®¡ç†**: ç»Ÿä¸€æ¥å£ç®¡ç†ä¸åŒå‚å•†çš„æ¨¡å‹

---

## æœ€ä½³å®ç°æ–¹æ¡ˆ

### 3.1 æ ¸å¿ƒè®¾è®¡åŸåˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          æ ¸å¿ƒè®¾è®¡åŸåˆ™                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. Code-First æ¶æ„                                                       â”‚
â”‚     â€¢ åº•å±‚æ˜¯ Python ä»£ç  (LangGraph DSL)                                    â”‚
â”‚     â€¢ å¯è§†åŒ–åªæ˜¯ä»£ç çš„æ¸²æŸ“å±‚                                                â”‚
â”‚     â€¢ æ”¯æŒåŒå‘ç¼–è¾‘ (ä»£ç  â†” å¯è§†åŒ–)                                          â”‚
â”‚                                                                             â”‚
â”‚  2. å®æ—¶åé¦ˆæœºåˆ¶                                                           â”‚
â”‚     â€¢ WebSocket å®æ—¶æ¨é€æ‰§è¡Œäº‹ä»¶                                            â”‚
â”‚     â€¢ å¯è§†åŒ–èŠ‚ç‚¹é«˜äº® (å½“å‰æ‰§è¡ŒèŠ‚ç‚¹è“è‰²è„‰å†²)                                 â”‚
â”‚     â€¢ çŠ¶æ€é¢æ¿å®æ—¶æ›´æ–°                                                     â”‚
â”‚                                                                             â”‚
â”‚  3. æ™ºèƒ½è¾…åŠ©                                                               â”‚
â”‚     â€¢ å¯¹è¯å¼åˆ›å»º (AI ç†è§£éœ€æ±‚ï¼Œç”Ÿæˆé…ç½®)                                    â”‚
â”‚     â€¢ æ™ºèƒ½ä»£ç ç”Ÿæˆ (UI æ“ä½œ â†’ Python ä»£ç )                                 â”‚
â”‚     â€¢ è‡ªåŠ¨ä¼˜åŒ–å»ºè®® (AI åˆ†ææ€§èƒ½ï¼Œæå‡ºä¼˜åŒ–)                                 â”‚
â”‚                                                                             â”‚
â”‚  4. å®Œæ•´è°ƒè¯•èƒ½åŠ›                                                           â”‚
â”‚     â€¢ å®æ—¶æ‰§è¡Œè¿½è¸ª                                                         â”‚
â”‚     â€¢ æ—¶é—´æ—…è¡Œè°ƒè¯• (ç‚¹å‡»å†å²äº‹ä»¶æŸ¥çœ‹çŠ¶æ€)                                   â”‚
â”‚     â€¢ æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œ                                                       â”‚
â”‚                                                                             â”‚
â”‚  5. ä¸€é”®éƒ¨ç½²                                                               â”‚
â”‚     â€¢ å¤šç¯å¢ƒæ”¯æŒ (å¼€å‘/æµ‹è¯•/ç”Ÿäº§)                                          â”‚
â”‚     â€¢ å¤šå½¢å¼è¾“å‡º (API/Web/åµŒå…¥/ä»£ç )                                       â”‚
â”‚     â€¢ ç‰ˆæœ¬ç®¡ç†å’Œå›æ»š                                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å·¥ä½œæµä»£ç å­˜å‚¨æ–¹æ¡ˆ

#### æ–¹æ¡ˆä¸€ï¼šæ•°æ®åº“å­˜å‚¨ (æ¨è)

**ä½ç½®**: `workflows` è¡¨çš„ `code` å­—æ®µ (TEXT)

```python
# backend/models/workflow.py

class Workflow(Base):
    """å·¥ä½œæµæ¨¡å‹"""

    id: UUID
    name: str
    code: str = Column(Text)  # Python ä»£ç å­˜å‚¨åœ¨è¿™é‡Œ
    config: dict = Column(JSONB)  # å…ƒæ•°æ®é…ç½®
    created_at: datetime
    updated_at: datetime
```

**ä¼˜åŠ¿**:
- âœ… ç»Ÿä¸€ç®¡ç†ï¼Œæ˜“äºæŸ¥è¯¢å’Œç‰ˆæœ¬æ§åˆ¶
- âœ… æ”¯æŒäº‹åŠ¡ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§
- âœ… å¯ä»¥å…³è”åˆ°ç”¨æˆ·ã€Agent ç­‰å®ä½“

**åŠ£åŠ¿**:
- âš ï¸ å¤§æ–‡ä»¶å¯èƒ½å½±å“æ•°æ®åº“æ€§èƒ½

#### æ–¹æ¡ˆäºŒï¼šæ–‡ä»¶ç³»ç»Ÿå­˜å‚¨

**ä½ç½®**: `backend/workflows/{workflow_id}/code.py`

```python
# æ–‡ä»¶ç³»ç»Ÿç»“æ„
backend/
â””â”€â”€ workflows/
    â””â”€â”€ {workflow_id}/
        â”œâ”€â”€ code.py          # å·¥ä½œæµä»£ç 
        â”œâ”€â”€ config.json      # é…ç½®æ–‡ä»¶
        â””â”€â”€ versions/        # ç‰ˆæœ¬å†å²
            â”œâ”€â”€ v1.py
            â””â”€â”€ v2.py
```

**ä¼˜åŠ¿**:
- âœ… ä»£ç æ–‡ä»¶å¯ä»¥ç›´æ¥ç¼–è¾‘å’Œè°ƒè¯•
- âœ… æ”¯æŒ Git ç‰ˆæœ¬æ§åˆ¶
- âœ… IDE å‹å¥½

**åŠ£åŠ¿**:
- âš ï¸ éœ€è¦é¢å¤–çš„æ–‡ä»¶åŒæ­¥æœºåˆ¶
- âš ï¸ éƒ¨ç½²å’Œå¤‡ä»½å¤æ‚

#### æ¨èæ–¹æ¡ˆï¼šæ··åˆå­˜å‚¨

```python
# æ•°æ®åº“å­˜å‚¨ä»£ç å†…å®¹ï¼ˆç”¨äºæŸ¥è¯¢å’Œç‰ˆæœ¬ç®¡ç†ï¼‰
workflows.code: TEXT  # å®Œæ•´ä»£ç 

# æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ï¼ˆç”¨äºå¼€å‘å’Œè°ƒè¯•ï¼‰
workflows/{id}/code.py  # å¯ç¼–è¾‘æ–‡ä»¶

# åŒæ­¥æœºåˆ¶
- ä¿å­˜æ—¶ï¼šæ•°æ®åº“ + æ–‡ä»¶ç³»ç»Ÿ
- åŠ è½½æ—¶ï¼šä¼˜å…ˆæ–‡ä»¶ç³»ç»Ÿï¼Œä¸å­˜åœ¨åˆ™ä»æ•°æ®åº“åŠ è½½
```

### 3.3 éƒ¨ç½²è¿è¡Œæ–¹æ¡ˆ

#### éƒ¨ç½²æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           éƒ¨ç½²æµç¨‹                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  1. ç”¨æˆ·ç‚¹å‡»"éƒ¨ç½²"                                                          â”‚
â”‚     â”‚                                                                       â”‚
â”‚     â–¼                                                                       â”‚
â”‚  2. ç¼–è¯‘å·¥ä½œæµ                                                              â”‚
â”‚     â€¢ è§£æ Python ä»£ç                                                      â”‚
â”‚     â€¢ éªŒè¯è¯­æ³•å’Œä¾èµ–                                                       â”‚
â”‚     â€¢ ç”Ÿæˆ AgentConfig                                                     â”‚
â”‚     â”‚                                                                       â”‚
â”‚     â–¼                                                                       â”‚
â”‚  3. åˆ›å»º Agent å®ä¾‹                                                         â”‚
â”‚     â€¢ åœ¨ agents è¡¨åˆ›å»ºè®°å½•                                                 â”‚
â”‚     â€¢ å…³è” workflow_id                                                     â”‚
â”‚     â€¢ è®¾ç½® compiled_config                                                 â”‚
â”‚     â”‚                                                                       â”‚
â”‚     â–¼                                                                       â”‚
â”‚  4. å¯åŠ¨æœåŠ¡å®ä¾‹                                                            â”‚
â”‚     â€¢ åŠ è½½ AgentConfig                                                     â”‚
â”‚     â€¢ åˆå§‹åŒ– AgentEngine                                                   â”‚
â”‚     â€¢ æ³¨å†Œ API è·¯ç”±                                                        â”‚
â”‚     â”‚                                                                       â”‚
â”‚     â–¼                                                                       â”‚
â”‚  5. è¿”å›éƒ¨ç½²ä¿¡æ¯                                                            â”‚
â”‚     â€¢ API ç«¯ç‚¹                                                             â”‚
â”‚     â€¢ API Key                                                              â”‚
â”‚     â€¢ æ–‡æ¡£é“¾æ¥                                                             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä»£ç å®ç°

```python
# backend/core/studio/deployer/deployer.py

class WorkflowDeployer:
    """å·¥ä½œæµéƒ¨ç½²å™¨"""

    async def deploy(
        self,
        workflow_id: str,
        environment: str = "production",
        deploy_type: str = "api",
    ) -> Deployment:
        """
        éƒ¨ç½²å·¥ä½œæµ

        1. ç¼–è¯‘å·¥ä½œæµä»£ç  â†’ AgentConfig
        2. åˆ›å»º Agent å®ä¾‹
        3. å¯åŠ¨æœåŠ¡
        4. è¿”å›éƒ¨ç½²ä¿¡æ¯
        """
        # 1. è·å–å·¥ä½œæµ
        workflow = await self.workflow_service.get(workflow_id)

        # 2. ç¼–è¯‘ä»£ç 
        parser = LangGraphParser()
        workflow_def = parser.parse(workflow.code)

        converter = WorkflowConverter()
        agent_config = converter.convert(workflow_def)

        # 3. åˆ›å»º Agent å®ä¾‹
        agent = Agent(
            id=uuid.uuid4(),
            name=workflow.name,
            system_prompt=agent_config.system_prompt,
            model=agent_config.model,
            tools=agent_config.tools,
            config={
                "workflow_id": str(workflow.id),
                "compiled_config": agent_config.model_dump(),
            },
        )
        await self.agent_service.create(agent)

        # 4. å¯åŠ¨æœåŠ¡ (æ ¹æ®éƒ¨ç½²ç±»å‹)
        if deploy_type == "api":
            endpoint = await self._deploy_as_api(agent, environment)
        elif deploy_type == "web":
            endpoint = await self._deploy_as_web(agent, environment)
        elif deploy_type == "embed":
            endpoint = await self._deploy_as_embed(agent, environment)

        # 5. åˆ›å»ºéƒ¨ç½²è®°å½•
        deployment = Deployment(
            id=uuid.uuid4(),
            agent_id=agent.id,
            workflow_id=workflow.id,
            deploy_type=deploy_type,
            environment=environment,
            endpoint=endpoint,
            status="running",
        )
        await self.deployment_service.create(deployment)

        return deployment
```

### 3.4 å¯¹ç°æœ‰ Agent çš„å½±å“

#### å½±å“åˆ†æ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¯¹ç°æœ‰ Agent çš„å½±å“                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  å½±å“ç±»å‹          â”‚ å½±å“ç¨‹åº¦ â”‚ è¯´æ˜                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  æ•°æ®æ¨¡å‹          â”‚ æ— å½±å“   â”‚ å·¥ä½œæµå’Œ Agent å…±äº« agents è¡¨              â”‚
â”‚  æ‰§è¡Œå¼•æ“          â”‚ æ— å½±å“   â”‚ å·¥ä½œå°åˆ›å»ºçš„ Agent ä½¿ç”¨ç›¸åŒçš„ AgentEngine   â”‚
â”‚  API æ¥å£          â”‚ æ— å½±å“   â”‚ å·¥ä½œå° Agent é€šè¿‡ç›¸åŒçš„ /chat æ¥å£æ‰§è¡Œ      â”‚
â”‚  å·¥å…·ç³»ç»Ÿ          â”‚ æ— å½±å“   â”‚ å…±äº«ç›¸åŒçš„å·¥å…·æ³¨å†Œè¡¨                        â”‚
â”‚  è®°å¿†ç³»ç»Ÿ          â”‚ æ— å½±å“   â”‚ å…±äº«ç›¸åŒçš„è®°å¿†å­˜å‚¨                          â”‚
â”‚  æ€§èƒ½å½±å“          â”‚ è½»å¾®     â”‚ å·¥ä½œå°æµ‹è¯•è¿è¡Œå¯èƒ½å ç”¨èµ„æºï¼Œä½†å¯éš”ç¦»         â”‚
â”‚                                                                             â”‚
â”‚  æ€»ç»“: å·¥ä½œå°æ˜¯ç°æœ‰ Agent ç³»ç»Ÿçš„æ‰©å±•ï¼Œä¸ä¼šç ´åç°æœ‰åŠŸèƒ½                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### éš”ç¦»æ–¹æ¡ˆ

```python
# æµ‹è¯•è¿è¡Œä½¿ç”¨ç‹¬ç«‹çš„èµ„æºæ± 
class TestRunner:
    """æµ‹è¯•è¿è¡Œå™¨ - ä½¿ç”¨ç‹¬ç«‹èµ„æº"""

    def __init__(self):
        # ä½¿ç”¨ç‹¬ç«‹çš„ LLM Gateway (é™æµæ›´å®½æ¾)
        self.llm_gateway = LLMGateway(
            rate_limit=100,  # æµ‹è¯•ç¯å¢ƒé™æµ
        )

        # ä½¿ç”¨ç‹¬ç«‹çš„ä¼šè¯å­˜å‚¨ (æµ‹è¯•æ•°æ®ä¸æ±¡æŸ“ç”Ÿäº§)
        self.session_store = TestSessionStore()

        # ä½¿ç”¨ç‹¬ç«‹çš„å·¥å…·æ‰§è¡Œå™¨ (æ²™ç®±ç¯å¢ƒ)
        self.tool_executor = SandboxToolExecutor()
```

---

## æŠ€æœ¯æ¶æ„è®¾è®¡

### 4.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          æŠ€æœ¯æ¶æ„å›¾                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  å‰ç«¯å±‚ (React + Vite)                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Studio UI                                                           â”‚  â”‚
â”‚  â”‚  â€¢ Monaco Editor (ä»£ç ç¼–è¾‘)                                          â”‚  â”‚
â”‚  â”‚  â€¢ React Flow (å¯è§†åŒ–ç¼–æ’)                                           â”‚  â”‚
â”‚  â”‚  â€¢ WebSocket Client (å®æ—¶è¿½è¸ª)                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â”‚ REST API / WebSocket                  â”‚
â”‚                                    â–¼                                        â”‚
â”‚  æœåŠ¡å±‚ (FastAPI)                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Studio Service                                                       â”‚  â”‚
â”‚  â”‚  â€¢ Creator (å¯¹è¯åˆ›å»º)                                                â”‚  â”‚
â”‚  â”‚  â€¢ CodeGen (ä»£ç ç”Ÿæˆ)                                                 â”‚  â”‚
â”‚  â”‚  â€¢ Parser (ä»£ç è§£æ)                                                 â”‚  â”‚
â”‚  â”‚  â€¢ TestRunner (æµ‹è¯•è¿è¡Œ)                                              â”‚  â”‚
â”‚  â”‚  â€¢ Deployer (éƒ¨ç½²ç®¡ç†)                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â”‚ å†…éƒ¨è°ƒç”¨                               â”‚
â”‚                                    â–¼                                        â”‚
â”‚  æ ¸å¿ƒå±‚ (Agent Core)                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Agent Engine                                                        â”‚  â”‚
â”‚  â”‚  â€¢ Main Loop                                                         â”‚  â”‚
â”‚  â”‚  â€¢ Context Manager                                                   â”‚  â”‚
â”‚  â”‚  â€¢ Tool System                                                       â”‚  â”‚
â”‚  â”‚  â€¢ Memory System                                                     â”‚  â”‚
â”‚  â”‚  â€¢ LLM Gateway                                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  å­˜å‚¨å±‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL (å·¥ä½œæµã€Agentã€ä¼šè¯)                                     â”‚  â”‚
â”‚  â”‚  Redis (ç¼“å­˜ã€ä¼šè¯)                                                  â”‚  â”‚
â”‚  â”‚  Qdrant (å‘é‡å­˜å‚¨)                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å…³é”®ç»„ä»¶å®ç°

#### 4.2.1 ä»£ç è§£æå™¨

```python
# backend/core/studio/parser/graph_parser.py

class LangGraphParser:
    """LangGraph ä»£ç è§£æå™¨"""

    def parse(self, code: str) -> WorkflowDefinition:
        """
        è§£æ Python ä»£ç ï¼Œæå–å·¥ä½œæµå®šä¹‰

        æ”¯æŒ:
        - StateGraph å®šä¹‰
        - add_node() è°ƒç”¨
        - add_edge() è°ƒç”¨
        - add_conditional_edges() è°ƒç”¨
        """
        tree = ast.parse(code)

        nodes = []
        edges = []
        state_class = None

        for node in ast.walk(tree):
            # æå– StateGraph å®šä¹‰
            if isinstance(node, ast.Call):
                if self._is_state_graph(node):
                    state_class = self._extract_state_class(node)

            # æå–èŠ‚ç‚¹
            if isinstance(node, ast.Call):
                if self._is_add_node(node):
                    nodes.append(self._extract_node(node))

            # æå–è¾¹
            if isinstance(node, ast.Call):
                if self._is_add_edge(node):
                    edges.append(self._extract_edge(node))
                elif self._is_add_conditional_edges(node):
                    edges.extend(self._extract_conditional_edges(node))

        return WorkflowDefinition(
            nodes=nodes,
            edges=edges,
            state_class=state_class,
        )
```

#### 4.2.2 ä»£ç ç”Ÿæˆå™¨

```python
# backend/core/studio/codegen/graph_codegen.py

class LangGraphCodeGen:
    """LangGraph ä»£ç ç”Ÿæˆå™¨"""

    def from_react_flow(
        self,
        nodes: list[dict],
        edges: list[dict],
        state_class: str = "AgentState",
    ) -> str:
        """
        ä» React Flow æ•°æ®ç”Ÿæˆ Python ä»£ç 
        """
        lines = []

        # 1. å¯¼å…¥
        lines.append("from langgraph.graph import StateGraph, END")
        lines.append(f"from core.types import {state_class}")
        lines.append("")

        # 2. èŠ‚ç‚¹å‡½æ•°
        for node in nodes:
            lines.extend(self._generate_node_function(node))
            lines.append("")

        # 3. æ¡ä»¶å‡½æ•°
        for edge in edges:
            if edge.get("type") == "conditional":
                lines.extend(self._generate_condition_function(edge))
                lines.append("")

        # 4. å›¾å®šä¹‰
        lines.append(f"graph = StateGraph({state_class})")
        lines.append("")

        # 5. æ·»åŠ èŠ‚ç‚¹
        for node in nodes:
            lines.append(f'graph.add_node("{node["id"]}", {node["func_name"]})')

        lines.append("")

        # 6. æ·»åŠ è¾¹
        for edge in edges:
            if edge.get("type") == "conditional":
                lines.append(
                    f'graph.add_conditional_edges('
                    f'"{edge["source"]}", {edge["condition_func"]}'
                    f')'
                )
            else:
                lines.append(
                    f'graph.add_edge("{edge["source"]}", "{edge["target"]}")'
                )

        lines.append("")
        lines.append("app = graph.compile()")

        return "\n".join(lines)
```

#### 4.2.3 å®æ—¶è¿½è¸ª

```python
# backend/core/engine/agent.py

class AgentEngine:
    """Agent æ‰§è¡Œå¼•æ“ - æ”¯æŒå®æ—¶è¿½è¸ª"""

    async def run_with_trace(
        self,
        user_input: str,
        session_id: str,
    ) -> AsyncGenerator[EngineEvent, None]:
        """
        å¸¦è¿½è¸ªçš„æ‰§è¡Œ

        é€šè¿‡ WebSocket å®æ—¶æ¨é€äº‹ä»¶åˆ°å‰ç«¯
        """
        # åˆå§‹åŒ–è¿½è¸ªå™¨
        tracer = ExecutionTracer(session_id)

        try:
            # 1. èŠ‚ç‚¹è¿›å…¥
            yield tracer.node_enter("start")

            # 2. ä¸Šä¸‹æ–‡æ„å»º
            yield tracer.context_build_start()
            context = await self.context_manager.build(...)
            yield tracer.context_build_complete(context)

            # 3. LLMè°ƒç”¨
            yield tracer.llm_call_start(model="claude-3.5")
            async for chunk in self.llm_gateway.stream_chat(...):
                yield tracer.llm_stream_chunk(chunk)
            yield tracer.llm_call_complete()

            # 4. å·¥å…·è°ƒç”¨
            yield tracer.tool_call_start("query_order", args)
            result = await self.tool_executor.execute(...)
            yield tracer.tool_call_complete(result)

            # 5. èŠ‚ç‚¹å®Œæˆ
            yield tracer.node_exit("end")

        except Exception as e:
            yield tracer.error(str(e))
            raise
```

---

## å®æ–½è·¯çº¿å›¾

### 5.1 åˆ†é˜¶æ®µå®æ–½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å®æ–½è·¯çº¿å›¾                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Phase 1: åŸºç¡€å·¥ä½œå° (3-4å‘¨)                                                â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                                â”‚
â”‚  â–¡ å·¥ä½œæµæ•°æ®æ¨¡å‹ (workflows è¡¨)                                            â”‚
â”‚  â–¡ ä»£ç å­˜å‚¨å’Œç‰ˆæœ¬ç®¡ç†                                                        â”‚
â”‚  â–¡ åŸºç¡€ API (CRUD)                                                          â”‚
â”‚  â–¡ ç®€å•çš„å·¥ä½œæµç¼–è¾‘å™¨ (ä»£ç ç¼–è¾‘å™¨)                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ èƒ½åˆ›å»ºã€èƒ½ä¿å­˜        â”‚
â”‚                                                                             â”‚
â”‚  Phase 2: å¯è§†åŒ–ç¼–æ’ (4-5å‘¨)                                                 â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                                â”‚
â”‚  â–¡ React Flow é›†æˆ                                                          â”‚
â”‚  â–¡ ä»£ç è§£æå™¨ (Python AST â†’ React Flow)                                    â”‚
â”‚  â–¡ ä»£ç ç”Ÿæˆå™¨ (React Flow â†’ Python)                                        â”‚
â”‚  â–¡ åŒå‘åŒæ­¥æœºåˆ¶                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ èƒ½å¯è§†åŒ–ã€èƒ½ç¼–è¾‘      â”‚
â”‚                                                                             â”‚
â”‚  Phase 3: å¯¹è¯åˆ›å»º & å®æ—¶è°ƒè¯• (3-4å‘¨)                                        â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                         â”‚
â”‚  â–¡ å¯¹è¯å¼åˆ›å»ºå™¨                                                             â”‚
â”‚  â–¡ æµ‹è¯•è¿è¡Œå™¨                                                               â”‚
â”‚  â–¡ å®æ—¶è¿½è¸ª (WebSocket)                                                     â”‚
â”‚  â–¡ å¯è§†åŒ–è°ƒè¯•ç•Œé¢                                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ èƒ½å¯¹è¯åˆ›å»ºã€èƒ½è°ƒè¯•      â”‚
â”‚                                                                             â”‚
â”‚  Phase 4: éƒ¨ç½² & æ¨¡æ¿ (3-4å‘¨)                                               â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                                â”‚
â”‚  â–¡ éƒ¨ç½²ç®¡ç†å™¨                                                               â”‚
â”‚  â–¡ API ç”Ÿæˆ                                                                 â”‚
â”‚  â–¡ æ¨¡æ¿å¸‚åœº                                                                 â”‚
â”‚  â–¡ ä»£ç å¯¼å‡º                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ èƒ½éƒ¨ç½²ã€èƒ½åˆ†äº«        â”‚
â”‚                                                                             â”‚
â”‚  Phase 5: ä¼˜åŒ– & é«˜çº§åŠŸèƒ½ (æŒç»­è¿­ä»£)                                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”                                          â”‚
â”‚  â–¡ æç¤ºè¯å·¥ç¨‹                                                               â”‚
â”‚  â–¡ A/B æµ‹è¯•                                                                 â”‚
â”‚  â–¡ æ€§èƒ½ä¼˜åŒ–                                                                 â”‚
â”‚  â–¡ æ›´å¤šèŠ‚ç‚¹ç±»å‹                                                             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ä¼˜å…ˆçº§æ’åº

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | åŸå›  | é¢„è®¡å·¥ä½œé‡ |
|------|-------|------|----------|
| **ä»£ç å­˜å‚¨å’Œç‰ˆæœ¬ç®¡ç†** | P0 | åŸºç¡€åŠŸèƒ½ï¼Œå¿…é¡»é¦–å…ˆå®ç° | 1å‘¨ |
| **ä»£ç è§£æå™¨** | P0 | å¯è§†åŒ–ç¼–æ’çš„æ ¸å¿ƒ | 2å‘¨ |
| **ä»£ç ç”Ÿæˆå™¨** | P0 | åŒå‘ç¼–è¾‘çš„æ ¸å¿ƒ | 2å‘¨ |
| **æµ‹è¯•è¿è¡Œå™¨** | P0 | è°ƒè¯•åŠŸèƒ½çš„æ ¸å¿ƒ | 2å‘¨ |
| **å®æ—¶è¿½è¸ª** | P0 | è°ƒè¯•ä½“éªŒçš„å…³é”® | 2å‘¨ |
| **å¯¹è¯å¼åˆ›å»º** | P1 | é™ä½ä½¿ç”¨é—¨æ§› | 2å‘¨ |
| **éƒ¨ç½²ç®¡ç†å™¨** | P1 | å¿«é€Ÿä¸Šçº¿ | 2å‘¨ |
| **æ¨¡æ¿å¸‚åœº** | P1 | åŠ é€Ÿå¼€å‘ | 2å‘¨ |
| **æç¤ºè¯å·¥ç¨‹** | P2 | ä¼˜åŒ–åŠŸèƒ½ | 2å‘¨ |

---

## æ€»ç»“

### æœ€æœ‰ä»·å€¼çš„åœºæ™¯

1. **å¯¹è¯å¼åˆ›å»º** - é™ä½ä½¿ç”¨é—¨æ§›ï¼Œè®©ä¸šåŠ¡äººå‘˜ä¹Ÿèƒ½åˆ›å»º Agent
2. **å¯è§†åŒ–ç¼–æ’** - ç›´è§‚è®¾è®¡å¤æ‚å·¥ä½œæµï¼Œæé«˜å¼€å‘æ•ˆç‡
3. **å®æ—¶è°ƒè¯•è¿½è¸ª** - å¿«é€Ÿå®šä½é—®é¢˜ï¼ŒåŠ é€Ÿè¿­ä»£
4. **ä¸€é”®éƒ¨ç½²** - å¿«é€Ÿä¸Šçº¿ï¼Œé™ä½è¿ç»´æˆæœ¬

### æœ€ä½³å®ç°æ–¹æ¡ˆ

1. **Code-First æ¶æ„** - ä»£ç ä¸ºåº•å±‚ï¼Œå¯è§†åŒ–ä¸ºæ¸²æŸ“å±‚
2. **åŒå‘ç¼–è¾‘** - ä»£ç å’Œå¯è§†åŒ–å®æ—¶åŒæ­¥
3. **å®æ—¶è¿½è¸ª** - WebSocket æ¨é€æ‰§è¡Œäº‹ä»¶
4. **æ™ºèƒ½è¾…åŠ©** - AI å¸®åŠ©åˆ›å»ºå’Œä¼˜åŒ–

### å…³é”®æŠ€æœ¯ç‚¹

1. **ä»£ç å­˜å‚¨**: æ•°æ®åº“ + æ–‡ä»¶ç³»ç»Ÿæ··åˆå­˜å‚¨
2. **ä»£ç è§£æ**: Python AST è§£ææå–å›¾ç»“æ„
3. **ä»£ç ç”Ÿæˆ**: ä»å¯è§†åŒ–æ•°æ®ç”Ÿæˆ Python ä»£ç 
4. **å®æ—¶è¿½è¸ª**: WebSocket æ¨é€æ‰§è¡Œäº‹ä»¶

---

<div align="center">

**å¯¹è¯åˆ›å»º Â· å¯è§†åŒ–ç¼–æ’ Â· å®æ—¶è°ƒè¯• Â· ä¸€é”®éƒ¨ç½²**

*æ–‡æ¡£ç‰ˆæœ¬: v1.0.0 | æœ€åæ›´æ–°: 2026-01-14*

</div>
